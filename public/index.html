<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel='stylesheet' href='style/style.css'>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tinos:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital@1&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Диваный островок</title>
</head>

<body>

    <div class='header'>
        <div class='container'>
            <div class='header-line'>

                <div id='ordersDropdownContainer'></div>

                <div class='nav' id="gg">
                    <a class='nav-item' href="#gg">ГЛАВНАЯ</a>
                    <a class='nav-item' href="#menu-titledesk">КАТАЛОГ</a>
                    <a class='nav-item' href="#уу">О НАС</a>
                    <a class='nav-item' href="oform.html">ОФОРМЛЕНИЕ</a>
                </div>

                <div class='cart'>
                    <a href="#">
                        <img class='cart-img' src="*" alt="">
                    </a>
                </div>

                <div class='phone'>
                    <div class='phone-holder'>
                        <div class='phone-img'>
                            <img src="style/Images/phone.png" alt="">
                        </div>

                        <div class='number'><a class='num' href='#'>+7 920 009 52 95</a></div>
                    </div>

                    <div class='phone-text'>
                        Свяжитесь с нами для <br> заказа дивана
                    </div>
                </div>

                <div class='btn' id='authButtonContainer'>
                    <a class='button' href='vh.html' id='authButton'>Регистрация/Войти</a>
                </div>

                <div class='burger-menu'>
                    <button id='burger'>
                        <img src="style/Images/burger-img.png" alt="">
                    </button>

                    <div id='menu' class='burger-slide disp'>
                        <a class='nav-item block' href="#gg">ГЛАВНАЯ</a>
                        <a class='nav-item block' href="#menu-titledesk">КАТАЛОГ</a>
                        <a class='nav-item block' href="#уу">О НАС</a>
                        <a class='nav-item block' href="oform.html">ЗАКАЗАТЬ</a>
                        <a class='nav-item block' href="vh.html">ВХОД</a>
                    </div>
                </div>
            </div>

            <div class='header-down'>
                <div class='header-title'>
                    Добро пожаловать в
                    <div class='header-subtitle'>
                        Диваный островок
                    </div>
                    <div class='header-suptitle'>
                        ОСТРОВОК ЛУЧШИХ ДИВАНОВ
                    </div>
                    <div class='header-bth'>
                        <a href="#menu-titledesk" class='header-button'>КАТАЛОГ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class='cards'>
        <div class='container'>
            <div class='cards-holder'>
                <div class='card'>
                    <div class='card-image'>
                        <img class='card-img' src='style/Images/card.png'>
                    </div>
                    <div class='card-title'>
                        Быстрое оформление <span>Заказа</span>
                    </div>
                    <div class='card-desc'>
                        На нашем сайте можно оформить заказ всего лишь за 10 минут
                    </div>
                </div>

                <div class='card'>
                    <div class='card-image'>
                        <img class='card-img' src='style/Images/card.png'>
                    </div>
                    <div class='card-title'>
                        Лучшее качество <span>Дивана</span>
                    </div>
                    <div class='card-desc'>
                        Качество нашего Дивана - отменное!
                    </div>
                </div>

                <div class='card'>
                    <div class='card-image'>
                        <img class='card-img' src='style/Images/card.png'>
                    </div>
                    <div class='card-title'>
                        Недорогие <span>Диваны</span>
                    </div>
                    <div class='card-desc'>
                        Стоимость наших диванов зависит только от количества. Качество всегда на высоте!
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class='history'>
        <div class='container'>
            <div class='history-holder'>
                <div class='history-info'>
                    <div class='history-title' id="уу">
                        Почему у <span>Нас</span>
                    </div>
                    <div class='history-desc'>
                        Оплата покупки по факту доставки<br>
                        Большой выбор материала обивки<br>
                        Высокое качество материала<br>
                        Удобный и простой механизм раскладывания<br>
                        Возможность установки независимого пружинного блока для глубокого сна(не на все модели)<br>
                        Просторный ящик для хранения вещей<br>
                        Возможность изменения габаритов<br>
                        Доставка по Москве и Московской области<br>
                        ❗️ ГАРАНТИЯ 12 месяцев❗️
                    </div>
                  
                </div>
                <div class='history-images'>
                    <img class='imgages-1' src="style/Images/1.jpg" alt="">
                    <img class='imgages-2' src="style/Images/2.jpg" alt="">
                    <img class='imgages-3' src="style/Images/3.jpg" alt="">
                </div>
            </div>
        </div>
    </div>

    <div class='black-block'>
        <div class='container'>
            <div class='block-holder'>
                <div class='left'>
                    <div class='left-title'>
                        Купите свой лучший диван <br> в самом лучшем магазине.
                    </div>
                    <div class='left-text'>
                        Только в этом месяце мини диван за 18.990 ₽
                    </div>
                </div>
                <div class='right'>
                    <div class='right-button'>
                        <a href='oform.html' class='right-btn'>ОФОРМИТЬ ЗАКАЗ</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class='dishes'>
        <div class='container'>
            <div class='dishes-title'>
                Наши <span>Ткани и цвета</span>
            </div>
            <div class='burgers' id="burgers">
                <div class='burgers-items'>
                    <div class='burger-item'>
                        <img src="style/Images/22.jpg" class='QQ'>
                        <div class='burger-text'>
                            Антивандальнгый
                        </div>
                    </div>
                    <div class='burger-item'>
                        <img src="style/Images/33.jpg" class='QQ2'>
                        <div class='burger-text'>
                            Матовый микро велюр
                        </div>
                    </div>
                    <div class='burger-item'>
                        <img src="style/Images/11.jpg" class='QQ1'>
                        <div class='burger-text'>
                            Барахатный микро велюр
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class='menu'>
        <div class='container'>
            <div class='menu-title' id="menu-titledesk">
                Наш каталог
            </div>
            <div class='menu-items'>
                <div class='menu-item'>
                    <div class='menu-image'>
                        <img src='style/Images/QW(2).jpg' class='menu-img'>
                    </div>
                    <div class='menu-text'>
                        Евро диван в стиле лофт
                    </div>
                    <div class='menu-subtext'>
                        Габариты: 215/140 <br> Спальное место: 185/140
                    </div>
                    <div class='menu-button'>
                        <a href='oform.html' class='menu-btn'>26.990 ₽</a>
                    </div>
                </div>
                <div class='menu-item'>
                    <div class='menu-image'>
                        <img src='style/Images/QWW.jpg' class='menu-img2'>
                    </div>
                    <div class='menu-text'>
                        Мини диваны раскладной
                    </div>
                    <div class='menu-subtext'>
                        Габариты: 140/90 <br> Спальное место: 120/185
                    </div>
                    <div class='menu-button'>
                        <a href='oform.html' class='menu-btn'>18.990 ₽</a>
                    </div>
                </div>
                <div class='menu-item'>
                    <div class='menu-image'>
                        <img src='style/Images/qwqw.jpg' class='menu-img1'>
                    </div>
                    <div class='menu-text'>
                        Евро диван в стиле лофт
                    </div>
                    <div class='menu-subtext'>
                        Габариты: 215/90 <br> Спальное место: 185/140
                    </div>
                    <div class='menu-button'>
                        <a href='oform.html' class='menu-btn'>25.990 ₽</a>
                    </div>
                </div>
            </div>
        </div>
    </div>







    <div class='footer'>
        Лучший магазин 2024
    </div>

    <script src='app.js'></script>
    <script>
        // Проверка статуса аутентификации при загрузке страницы
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('/auth/check');
                const result = await response.json();

                if (result.authenticated) {
                    document.getElementById('authButtonContainer').innerHTML = `
                    <div class='button'>Добро пожаловать, ${result.user.UserName}!</div>
                    <button id='logoutButton' class='button'>Выйти</button>
                `;

                    // Проверка на существование элемента
                    const logoutButton = document.getElementById('logoutButton');

                    if (logoutButton) {
                        logoutButton.addEventListener('click', async () => {
                            try {
                                const logoutResponse = await fetch('/auth/logout', { method: 'POST' });
                                const logoutResult = await logoutResponse.json();

                                if (logoutResponse.ok) {
                                    alert(logoutResult.message);
                                    window.location.href = '/vh.html'; // Перенаправление на страницу входа
                                } else {
                                    alert('Ошибка при выходе из аккаунта');
                                }
                            } catch (error) {
                                console.error('Ошибка при выходе из аккаунта:', error);
                                alert('Произошла ошибка при выходе из аккаунта');
                            }
                        });
                    } else {
                        console.error('Элемент с id="logoutButton" не найден');
                    }
                    // Получение списка заказов пользователя
                    const ordersResponse = await fetch('/orders');
                    const orders = await ordersResponse.json();

                    const ordersDropdown = document.createElement('select');
                    ordersDropdown.id = 'ordersDropdown';
                    ordersDropdown.innerHTML = `
                    <option value="" disabled selected>Ваши заказы</option>
                `;

                    orders.forEach(order => {
                        const option = document.createElement('option');
                        option.value = order.IdOrders;
                        option.text = `${order.NameDivan} - ${order.Price} ₽`;
                        ordersDropdown.appendChild(option);
                    });

                    // Добавление выпадающего списка в контейнер
                    document.getElementById('ordersDropdownContainer').appendChild(ordersDropdown);
                } else {
                    document.getElementById('authButtonContainer').innerHTML = `
                    <a class='button' href='vh.html' id='authButton'>Регистрация/Войти</a>
                `;
                }
            } catch (error) {
                console.error('Ошибка при проверке статуса аутентификации:', error);
            }
        });
    </script>
</body>

</html>